(this["webpackJsonpreact-typescript-starter-pack"]=this["webpackJsonpreact-typescript-starter-pack"]||[]).push([[0],{22:function(e,t,n){},25:function(e,t,n){"use strict";n.r(t);var r=n(1),a=n.n(r),c=n(11),o=(n(20),n(21),n(22),n(7)),s=n(6),i=n(2),u=n.n(i),l=n(4),d=n(3),b=n(5),j=n.n(b),f="https://mate.academy/students-api";function p(e){return new Promise((function(t){setTimeout(t,e)}))}function m(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"GET",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,r={method:t};return n&&(r.body=JSON.stringify(n),r.headers={"Content-Type":"application/json; charset=UTF-8"}),p(300).then((function(){return fetch(f+e,r)})).then((function(e){if(!e.ok)throw new Error;return e.json()}))}var O,h=function(e){return m(e)},v=function(e,t){return m(e,"POST",t)},x=function(e,t){return m(e,"PATCH",t)},g=function(e){return m(e,"DELETE")},T=function(e){return g("/todos/".concat(e))},y=function(e,t){return x("/todos/".concat(e),t)},k=function(){var e=Object(l.a)(u.a.mark((function e(t){var n;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,h("/users?email=".concat(t));case 2:return n=e.sent,e.abrupt("return",n[0]||null);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),N=function(){var e=Object(l.a)(u.a.mark((function e(t){var n,r;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.email,r=t.name,e.abrupt("return",v("/users",{email:n,name:r}));case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),w=n(0),E=function(e){var t=e.onLogin,n=Object(r.useState)(""),a=Object(d.a)(n,2),c=a[0],o=a[1],s=Object(r.useState)(""),i=Object(d.a)(s,2),b=i[0],f=i[1],p=Object(r.useState)(!1),m=Object(d.a)(p,2),O=m[0],h=m[1],v=Object(r.useState)(!1),x=Object(d.a)(v,2),g=x[0],T=x[1],y=Object(r.useState)(""),E=Object(d.a)(y,2),S=E[0],_=E[1],C=function(e){localStorage.setItem("user",JSON.stringify(e)),t(e)};Object(r.useEffect)((function(){var e=localStorage.getItem("user");if(e)try{var n=JSON.parse(e);t(n)}catch(r){}}),[]);var I=function(){var e=Object(l.a)(u.a.mark((function e(){var t;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,k(c);case 2:(t=e.sent)?C(t):h(!0);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),L=function(){var e=Object(l.a)(u.a.mark((function e(t){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.preventDefault(),_(""),T(!0),e.prev=3,!O){e.next=9;break}return e.next=7,N({name:b,email:c}).then(C);case 7:e.next=11;break;case 9:return e.next=11,I();case 11:e.next=16;break;case 13:e.prev=13,e.t0=e.catch(3),_("Something went wrtong");case 16:return e.prev=16,T(!1),e.finish(16);case 19:case"end":return e.stop()}}),e,null,[[3,13,16,19]])})));return function(t){return e.apply(this,arguments)}}();return Object(w.jsxs)("form",{onSubmit:L,className:"box mt-5",children:[Object(w.jsx)("h1",{className:"title is-3",children:O?"You need to register":"Log in to open todos"}),Object(w.jsxs)("div",{className:"field",children:[Object(w.jsx)("label",{className:"label",htmlFor:"user-email",children:"Email"}),Object(w.jsxs)("div",{className:j()("control has-icons-left",{"is-loading":g}),children:[Object(w.jsx)("input",{type:"email",id:"user-email",className:j()("input",{"is-danger":!O&&S}),placeholder:"Enter your email",disabled:g||O,value:c,required:!0,onChange:function(e){return o(e.target.value)}}),Object(w.jsx)("span",{className:"icon is-small is-left",children:Object(w.jsx)("i",{className:"fas fa-envelope"})})]}),!O&&S&&Object(w.jsx)("p",{className:"help is-danger",children:S})]}),O&&Object(w.jsxs)("div",{className:"field",children:[Object(w.jsx)("label",{className:"label",htmlFor:"user-name",children:"Your Name"}),Object(w.jsxs)("div",{className:j()("control has-icons-left",{"is-loading":g}),children:[Object(w.jsx)("input",{type:"text",id:"user-name",className:j()("input",{"is-danger":O&&S}),placeholder:"Enter your name",required:!0,minLength:4,disabled:g,value:b,onChange:function(e){return f(e.target.value)}}),Object(w.jsx)("span",{className:"icon is-small is-left",children:Object(w.jsx)("i",{className:"fas fa-user"})})]}),O&&S&&Object(w.jsx)("p",{className:"help is-danger",children:S})]}),Object(w.jsx)("div",{className:"field",children:Object(w.jsx)("button",{type:"submit",className:j()("button is-primary",{"is-loading":g}),children:O?"Register":"Login"})})]})},S=a.a.createContext(null),_=function(e){var t=e.children,n=Object(r.useState)(null),a=Object(d.a)(n,2),c=a[0],o=a[1];return c?Object(w.jsx)(S.Provider,{value:c,children:t}):Object(w.jsx)(E,{onLogin:o})},C=function(e){var t=e.error,n=e.setHideError,a=e.hideError,c=e.setError;return Object(r.useEffect)((function(){var e=window.setTimeout((function(){return c("")}),3e3);return function(){window.clearInterval(e)}}),[t]),Object(w.jsx)(w.Fragment,{children:t.length>0&&Object(w.jsxs)("div",{"data-cy":"ErrorNotification",className:j()("notification is-danger is-light has-text-weight-normal",{hidden:a}),children:[Object(w.jsx)("button",{"data-cy":"HideErrorButton",type:"button","aria-label":"delete",className:"delete",onClick:function(){return n(!0)}}),t]})})};function I(e){return e.filter((function(e){return e.completed}))}!function(e){e.All="all",e.Active="active",e.Completed="completed"}(O||(O={}));var L,A,F=function(e){var t=e.tabs,n=e.selectedTabId,a=e.onTabSelected,c=Object(r.useMemo)((function(){return t.find((function(e){return e.id===n}))||t[0]}),[n,t]),o=Object(r.useMemo)((function(){return function(e){n!==e.id&&a(e)}}),[n,t]);return Object(w.jsx)("nav",{className:"filter","data-cy":"Filter",children:t.map((function(e){return Object(w.jsx)("a",{href:"#".concat(e.id),"data-cy":"FilterLinkAll",className:j()("filter__link",{selected:e.id===c.id}),onClick:function(){return o(e)},children:e.title},e.id)}))})};(A=L||(L={})).TitleError="Title can't be empty",A.AddError="Unable to add a todo",A.DeleteError="Unable to delete a todo",A.UpdateError="Unable to update a todo";var D=function(e){var t=e.todos,n=e.tabs,a=e.selectedTabId,c=e.setTodos,o=e.setError,i=e.setToggleAll,d=e.onTabSelected,b=Object(r.useMemo)((function(){return t.filter((function(e){return!e.completed}))}),[t]),j=Object(r.useMemo)((function(){return I(t)}),[t]);j.length===t.length?i(!0):i(!1);var f=Object(r.useCallback)(function(){var e=Object(l.a)(u.a.mark((function e(t){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:try{t.forEach(function(){var e=Object(l.a)(u.a.mark((function e(t){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,T(t.id);case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),c(Object(s.a)(b))}catch(n){o(L.DeleteError)}case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),[j.length]);return Object(w.jsxs)("footer",{className:"todoapp__footer","data-cy":"Footer",children:[Object(w.jsx)("span",{className:"todo-count","data-cy":"todosCounter",children:"".concat(b.length," items left")}),Object(w.jsx)(F,{tabs:n,selectedTabId:a,onTabSelected:d}),Object(w.jsx)("button",{"data-cy":"ClearCompletedButton",type:"button",className:"todoapp__clear-completed",onClick:function(){return f(j)},children:j.length>0&&"Clear completed"})]})},U=function(e){var t=e.newTodoField,n=e.newTodoTitle,a=e.setNewTodoTitle,c=e.setError,o=e.setTodos,i=e.setIsLoading,d=e.setTempTitle,b=e.user,j=e.isLoading;Object(r.useEffect)((function(){t.current&&t.current.focus()}),[]);var f=Object(r.useCallback)((function(e){a(e.target.value),d(e.target.value)}),[]),p=Object(r.useCallback)(function(){var e=Object(l.a)(u.a.mark((function e(t){var r;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.preventDefault(),0!==n.trim().length){e.next=4;break}return c(L.TitleError),e.abrupt("return");case 4:if(i(!0),e.prev=5,!b){e.next=11;break}return e.next=9,u=n,l=null===b||void 0===b?void 0:b.id,v("/todos",{title:u,userId:l,completed:!1});case 9:r=e.sent,o((function(e){return[].concat(Object(s.a)(e),[r])}));case 11:e.next=16;break;case 13:e.prev=13,e.t0=e.catch(5),c(L.AddError);case 16:return e.prev=16,i(!1),a(""),e.finish(16);case 20:case"end":return e.stop()}var u,l}),e,null,[[5,13,16,20]])})));return function(t){return e.apply(this,arguments)}}(),[n]);return Object(w.jsx)("form",{onSubmit:p,children:Object(w.jsx)("input",{"data-cy":"NewTodoField",type:"text",ref:t,value:n,className:"todoapp__new-todo",placeholder:"What needs to be done?",onChange:f,disabled:j})})},B=function(e){var t=e.completed,n=e.title,a=e.id,c=e.setTodos,i=e.setError,b=e.todos,f=e.setSelectedTodoId,p=e.selectedTodoId,m=Object(r.useState)(!1),O=Object(d.a)(m,2),h=O[0],v=O[1],x=Object(r.useState)(n),g=Object(d.a)(x,2),k=g[0],N=g[1],E=Object(r.useRef)(null);Object(r.useEffect)((function(){E.current&&E.current.focus()}),[h]);var S=Object(r.useCallback)(function(){var e=Object(l.a)(u.a.mark((function e(t){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return f(t),e.prev=1,e.next=4,T(t);case 4:c((function(e){return Object(s.a)(e).filter((function(e){return e.id!==t}))})),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(1),i(L.DeleteError);case 10:return e.prev=10,f(0),e.finish(10);case 13:case"end":return e.stop()}}),e,null,[[1,7,10,13]])})));return function(t){return e.apply(this,arguments)}}(),[a]),_=Object(r.useCallback)(function(){var e=Object(l.a)(u.a.mark((function e(t){var n,r;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return f(t),e.prev=1,n=b.find((function(e){return e.id===t})),e.next=5,y(t,{completed:!(null===n||void 0===n?void 0:n.completed)});case 5:r=e.sent,c((function(e){return Object(s.a)(e).map((function(e){return e.id===t?Object(o.a)({},r):e}))})),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(1),i(L.UpdateError);case 12:return e.prev=12,f(0),e.finish(12);case 15:case"end":return e.stop()}}),e,null,[[1,9,12,15]])})));return function(t){return e.apply(this,arguments)}}(),[a,t]),C=Object(r.useCallback)((function(e){N(e.target.value)}),[]),I=Object(r.useCallback)((function(e){"Escape"===e.key&&v(!1)}),["keydown"]),A=Object(r.useCallback)(Object(l.a)(u.a.mark((function e(){var t;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(0!==k.trim().length){e.next=4;break}S(a),e.next=19;break;case 4:return f(a),e.prev=5,e.next=8,y(a,{title:k});case 8:t=e.sent,c((function(e){return Object(s.a)(e).map((function(e){return e.id===a?Object(o.a)({},t):e}))})),e.next=15;break;case 12:e.prev=12,e.t0=e.catch(5),i(L.UpdateError);case 15:return e.prev=15,f(0),v(!1),e.finish(15);case 19:case"end":return e.stop()}}),e,null,[[5,12,15,19]])}))),[k,h]);return Object(w.jsxs)("div",{"data-cy":"Todo",className:j()("todo",{completed:t}),children:[Object(w.jsx)("label",{className:"todo__status-label",children:Object(w.jsx)("input",{"data-cy":"TodoStatus",type:"checkbox",className:"todo__status",checked:t,onChange:function(){return _(a)}})}),h&&Object(w.jsx)("form",{onSubmit:function(e){e.preventDefault(),A()},children:Object(w.jsx)("input",{"data-cy":"TodoTitleField",type:"text",className:"todo__title-field",value:k,onChange:C,onBlur:A,ref:E,onKeyDown:I})}),!h&&Object(w.jsx)("span",{"data-cy":"TodoTitle",className:"todo__title",onDoubleClick:function(){return v(!0)},children:n}),!h&&Object(w.jsx)("button",{type:"button",className:"todo__remove","data-cy":"TodoDeleteButton",onClick:function(){return S(a)},children:"\xd7"}),Object(w.jsxs)("div",{"data-cy":"TodoLoader",className:j()("modal overlay",{"is-active":p===a}),children:[Object(w.jsx)("div",{className:"modal-background has-background-white-ter"}),Object(w.jsx)("div",{className:"loader"})]})]})},M=function(e){var t=e.todos,n=e.setError,r=e.setTodos,a=e.isLoading,c=e.setSelectedTodoId,o=e.selectedTodoId,s={id:0,title:e.tempTitle};return Object(w.jsxs)("section",{className:"todoapp__main","data-cy":"TodoList",children:[t.map((function(e){var a=e.id,s=e.completed,i=e.title;return Object(w.jsx)(B,{title:i,completed:s,id:a,setError:n,setTodos:r,todos:t,selectedTodoId:o,setSelectedTodoId:c},a)})),a&&Object(w.jsxs)("div",{"data-cy":"Todo",className:"todo",children:[Object(w.jsx)("label",{className:"todo__status-label",children:Object(w.jsx)("input",{"data-cy":"TodoStatus",type:"checkbox",className:"todo__status",defaultChecked:!0})}),Object(w.jsx)("span",{"data-cy":"TodoTitle",className:"todo__title",children:s.title}),Object(w.jsxs)("div",{"data-cy":"TodoLoader",className:"modal overlay is-active",children:[Object(w.jsx)("div",{className:"modal-background has-background-white-ter"}),Object(w.jsx)("div",{className:"loader"})]})]})]})},J=[{id:"",title:"All"},{id:"active",title:"Active"},{id:"completed",title:"Completed"}],H=function(){var e=Object(r.useContext)(S),t=Object(r.useRef)(null),n=Object(r.useState)([]),a=Object(d.a)(n,2),c=a[0],i=a[1],b=Object(r.useState)(""),f=Object(d.a)(b,2),p=f[0],m=f[1],v=Object(r.useState)(!1),x=Object(d.a)(v,2),g=x[0],T=x[1],k=Object(r.useState)(J[0].id),N=Object(d.a)(k,2),E=N[0],_=N[1],L=Object(r.useState)(""),A=Object(d.a)(L,2),F=A[0],B=A[1],H=Object(r.useState)(""),P=Object(d.a)(H,2),R=P[0],q=P[1],Y=Object(r.useState)(!1),G=Object(d.a)(Y,2),K=G[0],W=G[1],z=Object(r.useState)(null),Q=Object(d.a)(z,2),V=Q[0],X=Q[1],Z=Object(r.useState)(!1),$=Object(d.a)(Z,2),ee=$[0],te=$[1],ne=Object(r.useMemo)((function(){return J.find((function(e){return e.id===E}))||J[0]}),[E]);Object(r.useEffect)((function(){(function(){var t=Object(l.a)(u.a.mark((function t(){var n;return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,!e){t.next=7;break}return t.next=4,r=null===e||void 0===e?void 0:e.id,h("/todos?userId=".concat(r));case 4:n=t.sent,W(!1),i(n);case 7:t.next=12;break;case 9:t.prev=9,t.t0=t.catch(0),m("".concat(t.t0));case 12:case"end":return t.stop()}var r}),t,null,[[0,9]])})));return function(){return t.apply(this,arguments)}})()()}),[]);var re=Object(r.useMemo)((function(){return function(e,t){return e.filter((function(e){switch(t.id){case O.Active:return!e.completed;case O.Completed:return e.completed;default:return e}}))}(c,ne)}),[c,ne]),ae=Object(r.useMemo)((function(){return I(c)}),[c]),ce=Object(r.useCallback)((function(e){try{e.map(function(){var e=Object(l.a)(u.a.mark((function e(t){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(ae.length!==c.length){e.next=6;break}return e.next=3,y(t.id,{completed:!1});case 3:te(!1),e.next=8;break;case 6:return e.next=8,y(t.id,{completed:!0});case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),i((function(e){return Object(s.a)(e).map((function(e){return ae.length===c.length?Object(o.a)(Object(o.a)({},e),{},{completed:!1}):Object(o.a)(Object(o.a)({},e),{},{completed:!0})}))}))}catch(t){m("Unable to update a todo")}}),[c,ae]);return Object(w.jsxs)("div",{className:"todoapp",children:[Object(w.jsx)("h1",{className:"todoapp__title",children:"todos"}),Object(w.jsxs)("div",{className:"todoapp__content",children:[Object(w.jsxs)("header",{className:"todoapp__header",children:[Object(w.jsx)("button",{"data-cy":"ToggleAllButton",type:"button","aria-label":"ToggleAllButton",className:j()("todoapp__toggle-all",{active:ee}),onClick:function(){return ce(c)}}),Object(w.jsx)(U,{newTodoField:t,newTodoTitle:F,setNewTodoTitle:B,setError:m,setTodos:i,setIsLoading:W,setTempTitle:q,user:e,isLoading:K})]}),c.length>0&&Object(w.jsxs)(w.Fragment,{children:[Object(w.jsx)(M,{todos:re,setTodos:i,setError:m,isLoading:K,selectedTodoId:V,setSelectedTodoId:X,tempTitle:R}),Object(w.jsx)(D,{tabs:J,selectedTabId:E,todos:c,setTodos:i,setError:m,setToggleAll:te,onTabSelected:function(e){_(e.id)}})]})]}),Object(w.jsx)(C,{error:p,setHideError:T,hideError:g,setError:m})]})},P=function(){return Object(w.jsx)(_,{children:Object(w.jsx)(H,{})})};Object(c.createRoot)(document.getElementById("root")).render(Object(w.jsx)(P,{}))}},[[25,1,2]]]);
//# sourceMappingURL=main.bb9ebe29.chunk.js.map